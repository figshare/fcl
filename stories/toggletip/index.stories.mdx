import { useState, useCallback } from 'react';
import { Meta, Story, Canvas, ArgsTable } from '@storybook/addon-docs/blocks';
import Info from "@figshare/fcl/icons/info/medium";
import { Button, IconButton, GenericButton} from "@figshare/fcl/button";

import { Toggletip, Trigger, Content, UncontrolledToggletip } from "@figshare/fcl/toggletip";
import styles from "./index.stories.css";

<Meta
  component={Toggletip}
  title="UI/Toggletip"
  parameters={{
    viewMode: 'docs',
    previewTabs: { 
      canvas: { hidden: true } 
     },
  }}
/>

# Toggletip
---

- [Overview](#overview)
- [Props](#props-tables)
    - [Toggletip](#props-tables)
    - [Trigger](#trigger)
    - [Content](#content)
- [Examples](#examples)

## Overview

A component that can be used to show a focusable, persistable tooltip tied to a any type of target node.
The persistent tooltip will get revealed when users click on the target or focus on it and press "Enter" or "Spacebar" keys. 
If the tooltip has focusable elements, focus will cycle through those elements. Users can exit the toggletip and return to the trigger by pressing "Escape".

<Story
  name="Toggletip"
  parameters={{
    layout: "centered",
  }}
>
  {() => {
    const [isVisible, setIsVisible] = useState(false);
    const onToggle = useCallback(() => {
      setIsVisible((visible) => !visible);
    });
    return (
      <Toggletip isVisible={isVisible} onToggle={onToggle}>
      {() => (
        <span>
          <Trigger>
            {({ ...triggerProps }) => (
              <div className={styles.wrapperDiv} { ...triggerProps }>
                <Button>Button Trigger</Button>
              </div>
            )}
          </Trigger>
          <Content>
            {() => (
              <span> 
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
                <button>Focusable element</button>
                Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
                
                pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
              </span>
              )}
          </Content>
        </span>
        )}
      </Toggletip>
    );
  }}
</Story>

The component is a composite of a `Manager - Trigger - Content` set similar to other popup component implementations,
and can be imported from:

```jsx
import Toggletip, { Trigger, Content } from "@figshare/fcl/toggletip";

function MyToggletip() {
  const [isVisible, setIsVisible] = useState(false);
  const onToggle = useCallback(() => {
    setIsVisible((visible) => !visible);
  });

  return (
    <Toggletip isVisible={isVisible} onToggle={onToggle}>
      {() => (
        <span>
          <Trigger>
            {({ ...triggerProps }) => (
              <div className={styles.wrapperDiv} { ...triggerProps }>
                <Button>Button Trigger</Button>
              </div>
            )}
          </Trigger>
          <Content>
            {() => (
              <span> 
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
                <button>Focusable element</button>
                Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
                
                pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
              </span>
              )}
          </Content>
        </span>
        )}
    </Toggletip>
  );
}
```

We also export an `uncontrolled` version of the component for convenience, where we do not need to explicity control the visibility state:

```jsx
import { Trigger, Content, UncontrolledToggletip } from "@figshare/fcl/toggletip";

function MyUncontrolledToggletip() {
  return (
    <Toggletip isVisible={isVisible} onToggle={onToggle}>
      {() => (
        <span>
          <Trigger>
            {({ ...triggerProps }) => (
              <div className={styles.wrapperDiv} { ...triggerProps }>
                <Button>Button Trigger</Button>
              </div>
            )}
          </Trigger>
          <Content>
            {() => (
              <span> 
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
                <button>Focusable element</button>
                Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
                
                pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
              </span>
              )}
          </Content>
        </span>
        )}
    </Toggletip>
  );
}
```

## Props Tables
<br/>

### Toggletip
<ArgsTable of={Toggletip} />

### Trigger
<ArgsTable of={Trigger} />

### Content
<ArgsTable of={Content} />

## Examples

### Primary

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  <Button { ...props } innerRef={innerRef} >Button Trigger</Button>
        }}
      </Trigger>
      <Content>
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
  )}
</UncontrolledToggletip>

<br />

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  (      
            <div className={styles.wrapperDiv}>
              <IconButton
                {...props}
                Icon={Info}
                aria-label={"Icon trigger"}
                innerRef={innerRef}
              />
              Icon trigger
            </div>)
        }}
      </Trigger>
      <Content>
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>

<br />

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  <GenericButton { ...props } innerRef={innerRef} >Generic Button Trigger</GenericButton>
        }}
      </Trigger>
      <Content>
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>

---

### Secondary

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  <Button { ...props } innerRef={innerRef} >Button Trigger</Button>
        }}
      </Trigger>
      <Content theme="secondary">
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  (
            <div className={styles.wrapperDiv}>
              <IconButton
                {...props}
                Icon={Info}
                aria-label={"Icon trigger"}
                innerRef={innerRef}
              />
              Icon trigger
            </div>)
        }}
      </Trigger>
      <Content theme="secondary">
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>

<br />

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return <GenericButton { ...props } innerRef={innerRef} >Generic Button Trigger</GenericButton>
        }}
      </Trigger>
      <Content theme="secondary">
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>


```jsx
<div> Primary </div>

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  <Button { ...props } innerRef={innerRef} >Button Trigger</Button>
        }}
      </Trigger>
      <Content>
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
  )}
</UncontrolledToggletip>

<br />

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  (      
            <div className={styles.wrapperDiv}>
              <IconButton
                {...props}
                Icon={Info}
                aria-label={"Icon trigger"}
                innerRef={innerRef}
              />
              Icon trigger
            </div>)
        }}
      </Trigger>
      <Content>
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>

<br />

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  <GenericButton { ...props } innerRef={innerRef} >Generic Button Trigger</GenericButton>
        }}
      </Trigger>
      <Content>
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>

<div> Secondary </div>

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  <Button { ...props } innerRef={innerRef} >Button Trigger</Button>
        }}
      </Trigger>
      <Content theme="secondary">
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return  (
            <div className={styles.wrapperDiv}>
              <IconButton
                {...props}
                Icon={Info}
                aria-label={"Icon trigger"}
                innerRef={innerRef}
              />
              Icon trigger
            </div>)
        }}
      </Trigger>
      <Content theme="secondary">
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>

<br />

<UncontrolledToggletip>
  {() => (
    <span>
      <Trigger>
        {({ ...triggerProps }) => {
          const { ref: innerRef, ...props } = triggerProps;
          return <GenericButton { ...props } innerRef={innerRef} >Generic Button Trigger</GenericButton>
        }}
      </Trigger>
      <Content theme="secondary">
        {() => (
          <span> 
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent at turpis quis nisi sollicitudin cursus.
            <button>Focusable element</button>
            Morbi tincidunt posuere leo. Maecenas eu justo imperdiet, tempor magna at, tempus dui. Quisque ante augue,
            
            pellentesque venenatis commodo et, viverra et lectus. Etiam id vehicula dui. Quisque ac massa faucibus,
          </span>
          )}
      </Content>
    </span>
    )}
</UncontrolledToggletip>
```